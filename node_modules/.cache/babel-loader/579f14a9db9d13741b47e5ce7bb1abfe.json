{"ast":null,"code":"var _jsxFileName = \"C:\\\\Code\\\\ecom\\\\eCommerce_Reactjs\\\\src\\\\container\\\\System\\\\Message\\\\Message.js\",\n  _s = $RefreshSig$();\nimport React from 'react';\nimport { useEffect, useState, useRef } from 'react';\nimport { useFetchAllcode } from '../../customize/fetch';\nimport { listRoomOfAdmin } from '../../../services/userService';\nimport moment from 'moment';\nimport { toast } from 'react-toastify';\nimport { BrowserRouter as Router, Switch, Route, Link, Redirect } from \"react-router-dom\";\nimport MessageDisscution from '../../Message/MessageDisscution';\nimport ChatWindow from '../../Message/ChatWindow';\nimport socketIOClient from \"socket.io-client\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nrequire('dotenv').config();\nconst Message = () => {\n  _s();\n  const [dataUser, setdataUser] = useState({});\n  const [dataRoom, setdataRoom] = useState([]);\n  const [selectedRoom, setselectedRoom] = useState('');\n  const host = process.env.REACT_APP_BACKEND_URL;\n  const socketRef = useRef();\n  const [id, setId] = useState();\n  useEffect(() => {\n    socketRef.current = socketIOClient.connect(host);\n    const userData = JSON.parse(localStorage.getItem('userData'));\n    setdataUser(userData);\n    socketRef.current.on('getId', data => {\n      setId(data);\n    }); // phần này đơn giản để gán id cho mỗi phiên kết nối vào page. Mục đích chính là để phân biệt đoạn nào là của mình đang chat.\n    fetchListRoom();\n    socketRef.current.on('sendDataServer', dataGot => {\n      fetchListRoom();\n    });\n    socketRef.current.on('loadRoomServer', dataGot => {\n      fetchListRoom(userData.id);\n    });\n    return () => {\n      socketRef.current.disconnect();\n    };\n  }, []);\n  let handleClickRoom = roomId => {\n    socketRef.current.emit('loadRoomClient');\n    setselectedRoom(roomId);\n  };\n  let fetchListRoom = async () => {\n    let res = await listRoomOfAdmin();\n    if (res && res.errCode == 0) {\n      setdataRoom(res.data);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"container\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"ks-page-content\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"ks-page-content-body\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"ks-messenger\",\n          children: [/*#__PURE__*/_jsxDEV(MessageDisscution, {\n            userId: dataUser.id,\n            isAdmin: true,\n            handleClickRoom: handleClickRoom,\n            data: dataRoom\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 60,\n            columnNumber: 18\n          }, this), selectedRoom ? /*#__PURE__*/_jsxDEV(ChatWindow, {\n            userId: dataUser.id,\n            roomId: selectedRoom\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 61,\n            columnNumber: 34\n          }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n            children: /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"title\",\n              children: \"Ch\\u01B0a ch\\u1ECDn ph\\xF2ng\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 63,\n              columnNumber: 21\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 62,\n            columnNumber: 19\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 59,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 58,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 9\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 56,\n    columnNumber: 9\n  }, this);\n};\n_s(Message, \"pcnBV7Ac3x5f7ltWurODz4gzDsg=\");\n_c = Message;\nexport default Message;\nvar _c;\n$RefreshReg$(_c, \"Message\");","map":{"version":3,"names":["React","useEffect","useState","useRef","useFetchAllcode","listRoomOfAdmin","moment","toast","BrowserRouter","Router","Switch","Route","Link","Redirect","MessageDisscution","ChatWindow","socketIOClient","jsxDEV","_jsxDEV","require","config","Message","_s","dataUser","setdataUser","dataRoom","setdataRoom","selectedRoom","setselectedRoom","host","process","env","REACT_APP_BACKEND_URL","socketRef","id","setId","current","connect","userData","JSON","parse","localStorage","getItem","on","data","fetchListRoom","dataGot","disconnect","handleClickRoom","roomId","emit","res","errCode","className","children","userId","isAdmin","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/Code/ecom/eCommerce_Reactjs/src/container/System/Message/Message.js"],"sourcesContent":["import React from 'react';\r\nimport { useEffect, useState ,useRef} from 'react';\r\nimport { useFetchAllcode } from '../../customize/fetch';\r\nimport {  listRoomOfAdmin} from '../../../services/userService';\r\nimport moment from 'moment';\r\nimport { toast } from 'react-toastify';\r\n\r\nimport {\r\n    BrowserRouter as Router,\r\n    Switch,\r\n    Route,\r\n    Link,\r\n    Redirect\r\n} from \"react-router-dom\";\r\nimport MessageDisscution from '../../Message/MessageDisscution';\r\nimport ChatWindow from '../../Message/ChatWindow';\r\nimport socketIOClient from \"socket.io-client\";\r\nrequire('dotenv').config();\r\nconst Message = () => {\r\n  const [dataUser, setdataUser] = useState({})\r\n    const [dataRoom, setdataRoom] = useState([])\r\n  const [selectedRoom, setselectedRoom] = useState('')\r\n  const host = process.env.REACT_APP_BACKEND_URL;\r\n  const socketRef = useRef();\r\n  const [id, setId] = useState();\r\n  useEffect(()=>{\r\n    socketRef.current = socketIOClient.connect(host)\r\n    const userData = JSON.parse(localStorage.getItem('userData'));\r\n    setdataUser(userData)\r\n    socketRef.current.on('getId', data => {\r\n      setId(data)\r\n    }) // phần này đơn giản để gán id cho mỗi phiên kết nối vào page. Mục đích chính là để phân biệt đoạn nào là của mình đang chat.\r\n    fetchListRoom()\r\n    socketRef.current.on('sendDataServer', dataGot => {\r\n      fetchListRoom()\r\n      }) \r\n      socketRef.current.on('loadRoomServer', dataGot => {\r\n        fetchListRoom(userData.id)\r\n        })  \r\n      return () => {\r\n        socketRef.current.disconnect();\r\n      };\r\n  },[])\r\n let handleClickRoom = (roomId)=>{\r\n    socketRef.current.emit('loadRoomClient')\r\n    setselectedRoom(roomId)\r\n   \r\n }\r\n let fetchListRoom = async() =>{\r\n  let res = await listRoomOfAdmin()\r\n  if(res && res.errCode==0){\r\n    setdataRoom(res.data)\r\n  }\r\n}\r\n    return (\r\n        <div className=\"container\">\r\n        <div className=\"ks-page-content\">\r\n          <div className=\"ks-page-content-body\">\r\n            <div className=\"ks-messenger\">\r\n                 <MessageDisscution userId={dataUser.id} isAdmin={true} handleClickRoom={handleClickRoom} data={dataRoom}/>\r\n                 {selectedRoom ? <ChatWindow userId={dataUser.id} roomId={selectedRoom}  />\r\n                 :<div>\r\n                    <span className='title'>Chưa chọn phòng</span>\r\n                 </div> \r\n                }\r\n                \r\n             \r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    )\r\n}\r\nexport default Message;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}